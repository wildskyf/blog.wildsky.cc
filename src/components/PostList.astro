---
import dayjs from 'dayjs'
import Link from '@/components/Link.astro'
import ReadMoreButton from '../components/ReadMoreButton.astro'

const { lang, postList } = Astro.props
const root_path = lang == 'en' ? '/en' : ''
---

<ul class="flex flex-col px-4 lg:px-0" lang={lang === 'tw' ? 'zh-Hant-TW' : 'en'}>
  {
    postList.map(post => {
      return (
        <li
          key={post.guid}
          class='rounded-xl mb-12'
        >
          <article class={
            `bg-transparent
              text-skadiWhite-300
              px-3 py-6
              rounded-xl
              ${lang === 'tw' ? 'tracking-tw-normal' : ''}
            `}
          >
            <header>
              <Link href={`${root_path}/posts/${post.slug}`}>
                <h2
                  class='mb-4 text-2xl lg:text-3xl font-semibold'
                  set:html={post.title}
                  style={{ hyphens: 'auto' }}
                />
              </Link>
              <p class='text-lg mb-4'>
                Posted on <time dateTime={post.date}>{dayjs(post.date).format('YYYY 年 MM 月 DD 日')}</time>
              </p>
            </header>
            {
              post.feature_image_url && (
                <Link href={`${root_path}/posts/${post.slug}`}>
                  <img
                    class='opacity-70'
                    src={post.feature_image_url}
                    alt=''
                    width='750'
                    height='410'
                  />
                </Link>
              )
            }
            <div class="mt-8 text-xl pb-4">
              <div
                class="break-all article-content"
                set:html={
                  post.excerpt?.split('\n').map(a => `<p>${a}</p>`).join('')
                }
              />
              <div>
                <ReadMoreButton to={`${root_path}/posts/${post.slug}`} />
              </div>
            </div>
          </article>
        </li>
      )
    })
  }
</ul>
